{
  "hash": "6f561d0b02c5cdbbc7c5310d0ffe7143",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home_Ex03\"\nauther: \"Hei Yee Kai\"\ndate: \"October 30, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\nformat:\n  html:\n    toc: true\n---\n\n\n# **Introduction**\n\n## **Importing Packages**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, st, tidyverse, raster, tmap, tmaptools, ggplot2, spatstat, sfdep)\n```\n:::\n\n\n## **Importing Dataset into R environment**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district <- read_csv(\"data/crime_district.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 19152 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): state, district, category, type\ndbl  (1): crimes\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmalaysia_sf <- read_sf(dsn = \"data/my_shp\", \n                 layer = \"mys_admbnda_adm2_unhcr_20210211\") %>%\n  st_as_sf(coords =c(\n    \"longitude\", \"latitude\"),\n           crs = 4326) %>%\n  st_transform(crs = 3168)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmalaysia_sf <- malaysia_sf %>%\nfilter(ADM1_EN != 'W.P. Labuan' & ADM1_EN != 'Sabah' & ADM1_EN != 'Sarawak') %>%\n          mutate(ADM1_EN = replace(ADM1_EN, ADM1_EN == 'W.P. Kuala Lumpur', 'Kuala Lumpur'),\n                 ADM1_EN = replace(ADM1_EN, ADM1_EN == 'W.P. Putrajaya', 'Selangor'), \n                 ADM1_EN = toupper(ADM1_EN),\n                 ADM2_EN = toupper(ADM2_EN))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmalaysia_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 87 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2\nProjected CRS: Kertau (RSO) / RSO Malaya (m)\n# A tibble: 87 × 15\n   ADM2_EN  ADM2_PCODE ADM2_REF ADM2ALT1EN ADM2ALT2EN ADM1_EN ADM1_PCODE ADM0_EN\n * <chr>    <chr>      <chr>    <chr>      <chr>      <chr>   <chr>      <chr>  \n 1 BATU PA… MY0101     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 2 JOHOR B… MY0102     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 3 KLUANG   MY0103     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 4 KOTA TI… MY0104     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 5 KULAIJA… MY0105     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 6 LEDANG   MY0106     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 7 MERSING  MY0107     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 8 MUAR     MY0108     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n 9 PONTIAN  MY0109     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n10 SEGAMAT  MY0110     <NA>     <NA>       <NA>       JOHOR   MY01       Malays…\n# ℹ 77 more rows\n# ℹ 7 more variables: ADM0_PCODE <chr>, date <date>, validOn <date>,\n#   validTo <date>, Shape_Leng <dbl>, Shape_Area <dbl>,\n#   geometry <MULTIPOLYGON [m]>\n```\n\n\n:::\n:::\n\n\n# **Geospatial Data Wrangling**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district <- crime_district %>%\n              filter(state != 'Malaysia' & state != 'Sabah' & state != 'Sarawak') %>%\n              mutate(state = replace(state, state == 'W.P. Kuala Lumpur', 'Kuala Lumpur'),\n                     state = toupper(state),\n                     district = toupper(district)) %>%\n                  filter(district != 'ALL')  %>%\n                  filter(type != 'all') \ncrime_district\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10,368 × 6\n   state district   category type           date       crimes\n   <chr> <chr>      <chr>    <chr>          <date>      <dbl>\n 1 JOHOR BATU PAHAT assault  causing_injury 2016-01-01     39\n 2 JOHOR BATU PAHAT assault  causing_injury 2017-01-01     41\n 3 JOHOR BATU PAHAT assault  causing_injury 2018-01-01     28\n 4 JOHOR BATU PAHAT assault  causing_injury 2019-01-01     41\n 5 JOHOR BATU PAHAT assault  causing_injury 2020-01-01     43\n 6 JOHOR BATU PAHAT assault  causing_injury 2021-01-01     22\n 7 JOHOR BATU PAHAT assault  causing_injury 2022-01-01     19\n 8 JOHOR BATU PAHAT assault  causing_injury 2023-01-01     22\n 9 JOHOR BATU PAHAT assault  murder         2016-01-01      6\n10 JOHOR BATU PAHAT assault  murder         2017-01-01      0\n# ℹ 10,358 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district_malaysia <- malaysia_sf %>%\n  left_join(crime_district,\n            by = c(\"ADM1_EN\" = \"state\",\n                   \"ADM2_EN\" = \"district\")) %>%\n  dplyr::select(1, 6, 13:19)\n\ncrime_district_malaysia\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6546 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2\nProjected CRS: Kertau (RSO) / RSO Malaya (m)\n# A tibble: 6,546 × 9\n   ADM2_EN    ADM1_EN Shape_Leng Shape_Area                    geometry category\n   <chr>      <chr>        <dbl>      <dbl>          <MULTIPOLYGON [m]> <chr>   \n 1 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 2 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 3 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 4 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 5 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 6 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 7 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 8 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n 9 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n10 BATU PAHAT JOHOR         1.86      0.161 (((556714.6 192051.6, 5566… assault \n# ℹ 6,536 more rows\n# ℹ 3 more variables: type <chr>, date.y <date>, crimes <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district_malaysia_sf <- st_as_sf(crime_district_malaysia)\nst_crs(crime_district_malaysia_sf) <- st_crs(malaysia_sf)\n```\n:::\n\n\n# **EDA**\n\n## **Choropleth**\n\n### **Choropleth Map for Crime Rate by State**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to plotting\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(crime_district_malaysia_sf) +\n  tm_fill(\"crimes\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Crime Ratio\") +\n  tm_layout(main.title = \"Distribution of Crime Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_grid(alpha =0.2)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### **Choropleth Map for Crime Rate by Category**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(crime_district_malaysia_sf$category)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n assault property \n    3808     2720 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nassault_data <- subset(crime_district_malaysia_sf, category == \"assault\")\n\ntm_shape(assault_data) +\n  tm_fill(\"crimes\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Crime Ratio\") +\n  tm_layout(main.title = \"Distribution of Assault Crime Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_grid(alpha =0.2)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nproperty_data <- subset(crime_district_malaysia_sf, category == \"property\")\n\ntm_shape(property_data) +\n  tm_fill(\"crimes\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Crime Ratio\") +\n  tm_layout(main.title = \"Distribution of Property Crime Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_grid(alpha =0.2)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### **Choropleth Map for Crime Rate by Type**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(crime_district_malaysia_sf$type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                break_in           causing_injury                   murder \n                     544                      544                      544 \n                    rape       robbery_gang_armed     robbery_gang_unarmed \n                     544                      544                      544 \n      robbery_solo_armed     robbery_solo_unarmed              theft_other \n                     544                      544                      544 \n     theft_vehicle_lorry   theft_vehicle_motorcar theft_vehicle_motorcycle \n                     544                      544                      544 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_crime_map <- function(data, crime_type) {\n  crime_specific <- subset(data, type == crime_type)\n  \n  title <- paste(\"Distribution of\", \n                gsub(\"_\", \" \", crime_type), \n                \"in Malaysia\")\n  \n  tm_shape(crime_specific) +\n    tm_fill(\"crimes\",\n            palette = \"Blues\",\n            style = \"quantile\",\n            n = 5,\n            title = \"Number of Cases\") +\n    tm_borders(lwd = 0.1, alpha = 1) +\n    tm_layout(\n      main.title = title,\n      main.title.position = \"center\",\n      main.title.size = 1.2,\n      legend.height = 0.45, \n      legend.width = 0.35,\n      frame = TRUE) +\n    tm_grid(alpha =0.2)\n}\n\nplot_list <- list()\ncrime_types <- c(\"break_in\", \"causing_injury\", \"murder\", \"rape\", \n                 \"robbery_gang_armed\", \"robbery_gang_unarmed\", \n                 \"robbery_solo_armed\", \"robbery_solo_unarmed\", \n                 \"theft_other\", \"theft_vehicle_lorry\", \n                 \"theft_vehicle_motorcar\", \"theft_vehicle_motorcycle\")\n\nfor (type in crime_types) {\n  # Filter data for specific crime type\n\n  p <- create_crime_map(crime_district_malaysia_sf, type)\n  plot_list[[type]] <- p\n}\n\ntmap_arrange(plotlist = plot_list, ncol = 3, nrow = 4)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## **Histogram**\n\n### **Preparing Data for Histograms**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_data_clean <- na.omit(crime_district_malaysia_sf)\n```\n:::\n\n\n### **Histogram for Crime Rate by Category**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(crime_data_clean, aes(x = crimes, fill = category)) +\n  geom_histogram(color = \"black\", \n                 bins = 30, \n                 position = \"identity\", \n                 alpha = 0.7) +\n  labs(title = \"Distribution of Crimes by Category\",\n       x = \"Number of Cases\",\n       y = \"Frequency\",\n       fill = \"Category\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"bottom\") +\n  scale_fill_manual(values = c(\"assault\" = \"#FF9999\", \"property\" = \"#66B2FF\"))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(crime_data_clean, aes(x = crimes, fill = category)) +\n  geom_density(alpha = 0.7) +\n  labs(title = \"Density Distribution of Crimes by Category\",\n       x = \"Number of Cases\",\n       y = \"Density\",\n       fill = \"Category\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"bottom\") +\n  scale_fill_manual(values = c(\"assault\" = \"#FF9999\", \"property\" = \"#66B2FF\"))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(crime_data_clean, aes(x = category, y = crimes, fill = category)) +\n  geom_boxplot() +\n  labs(title = \"Distribution of Crime Cases by Category\",\n       x = \"Category\",\n       y = \"Number of Cases\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"none\") +\n  scale_fill_manual(values = c(\"assault\" = \"#FF9999\", \"property\" = \"#66B2FF\"))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n### **Histogram for Crime Rate by Type**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(crime_data_clean, aes(x = crimes)) +\n  geom_histogram(fill = \"steelblue\", color = \"black\", bins = 30) +\n  labs(title = \"Distribution of All Crimes\",\n       x = \"Number of Cases\",\n       y = \"Frequency\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(crime_data_clean, aes(x = crimes, fill = type)) +\n  geom_histogram(color = \"black\", bins = 30, position = \"identity\", alpha = 0.5) +\n  labs(title = \"Distribution of Cases by Crime Type\",\n       x = \"Number of Cases\",\n       y = \"Frequency\") +\n  theme_minimal() +\n  theme(plot.title = element_text(hjust = 0.5),\n        legend.position = \"bottom\",\n        legend.title = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(crime in unique(crime_data_clean$type)) {\n  crime_data <- subset(crime_district_malaysia_sf, type == crime)\n  \n  print(\n    ggplot(crime_data, aes(x = crimes)) +\n      geom_histogram(fill = \"lightblue\", color = \"black\", bins = 20) +\n      labs(title = gsub(\"_\", \" \", toupper(crime)),\n           x = \"Number of Cases\",\n           y = \"Frequency\") +\n      theme_minimal() +\n      theme(plot.title = element_text(hjust = 0.5))\n  )\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-11.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-20-12.png){width=672}\n:::\n:::\n\n\n## **Summary**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategory_summary <- crime_data_clean %>%\n  group_by(category) %>%\n  summarise(\n    Count = n(),\n    Mean_Cases = mean(crimes),\n    Median_Cases = median(crimes),\n    SD_Cases = sd(crimes),\n    Min_Cases = min(crimes),\n    Max_Cases = max(crimes),\n    Total_Cases = sum(crimes)\n  ) %>%\n  mutate(\n    Percentage_of_Total = (Total_Cases / sum(Total_Cases)) * 100\n  )\n\nprint(\"Summary Statistics by Category:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Summary Statistics by Category:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(category_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 2 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 723622.2\nProjected CRS: Kertau (RSO) / RSO Malaya (m)\n# A tibble: 2 × 10\n  category Count Mean_Cases Median_Cases SD_Cases Min_Cases Max_Cases\n* <chr>    <int>      <dbl>        <dbl>    <dbl>     <dbl>     <dbl>\n1 assault   3808       11.4            3     26.8         0       528\n2 property  2720       65.8           31    109.          0      1192\n# ℹ 3 more variables: Total_Cases <dbl>, geometry <MULTIPOLYGON [m]>,\n#   Percentage_of_Total <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndetailed_summary <- crime_data_clean %>%\n  group_by(category, type) %>%\n  summarise(\n    Count = n(),\n    Mean_Cases = mean(crimes),\n    Median_Cases = median(crimes),\n    Total_Cases = sum(crimes)\n  ) %>%\n  arrange(category, desc(Total_Cases))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'category'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(\"\\nDetailed Summary by Category and Type:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"\\nDetailed Summary by Category and Type:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(detailed_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 12 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 723622.2\nProjected CRS: Kertau (RSO) / RSO Malaya (m)\n# A tibble: 12 × 7\n# Groups:   category [2]\n   category type                     Count Mean_Cases Median_Cases Total_Cases\n   <chr>    <chr>                    <int>      <dbl>        <dbl>       <dbl>\n 1 assault  causing_injury             544    27.8            19         15117\n 2 assault  robbery_gang_unarmed       544    23.6             8         12864\n 3 assault  robbery_solo_unarmed       544    14.6             6          7926\n 4 assault  rape                       544    12.0            10          6529\n 5 assault  murder                     544     1.62            1           883\n 6 assault  robbery_gang_armed         544     0.125           0            68\n 7 assault  robbery_solo_armed         544     0.0423          0            23\n 8 property theft_vehicle_motorcycle   544   122.             64         66521\n 9 property theft_other                544    93.7            59.5       50981\n10 property break_in                   544    82.3            48         44761\n11 property theft_vehicle_motorcar     544    24.6             9         13397\n12 property theft_vehicle_lorry        544     5.86            2          3190\n# ℹ 1 more variable: geometry <MULTIPOLYGON [m]>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntype_distribution <- crime_data_clean %>%\n  group_by(category, type) %>%\n  summarise(count = n()) %>%\n  mutate(percentage = count / sum(count) * 100)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'category'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(\"\\nPercentage Distribution of Types within Categories:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"\\nPercentage Distribution of Types within Categories:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(type_distribution)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 12 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 723622.2\nProjected CRS: Kertau (RSO) / RSO Malaya (m)\n# A tibble: 12 × 5\n# Groups:   category [2]\n   category type                     count                   geometry percentage\n * <chr>    <chr>                    <int>         <MULTIPOLYGON [m]>      <dbl>\n 1 assault  causing_injury             544 (((196019.2 689862.6, 196…       14.3\n 2 assault  murder                     544 (((196019.2 689862.6, 196…       14.3\n 3 assault  rape                       544 (((196019.2 689862.6, 196…       14.3\n 4 assault  robbery_gang_armed         544 (((196019.2 689862.6, 196…       14.3\n 5 assault  robbery_gang_unarmed       544 (((196019.2 689862.6, 196…       14.3\n 6 assault  robbery_solo_armed         544 (((196019.2 689862.6, 196…       14.3\n 7 assault  robbery_solo_unarmed       544 (((196019.2 689862.6, 196…       14.3\n 8 property break_in                   544 (((196019.2 689862.6, 196…       20  \n 9 property theft_other                544 (((196019.2 689862.6, 196…       20  \n10 property theft_vehicle_lorry        544 (((196019.2 689862.6, 196…       20  \n11 property theft_vehicle_motorcar     544 (((196019.2 689862.6, 196…       20  \n12 property theft_vehicle_motorcycle   544 (((196019.2 689862.6, 196…       20  \n```\n\n\n:::\n:::\n",
    "supporting": [
      "Take-Home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}